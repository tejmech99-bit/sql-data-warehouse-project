insert into silver.crm_cust_info 
( 
cst_id,
cst_key,
cst_firstname,
cst_lastname,
cst_marital_status,
cst_gndr,
cst_create_date
)

select
    cst_id,
    cst_key,
    trim(cst_firstname) as cst_firstname, -- unwanted space
    trim(cst_lastname) as cst_lastname,   -- unwanted space
    case when       upper(trim(cst_marital_status)) = 'S' then 'Sigle'
	    when        upper(trim(cst_marital_status)) = 'M' then 'Married'
		else 'n/a'
		end cst_marital_status,
    case when upper(trim(cst_gndr)) = 'f' then 'Female' --project always use full name and insted of null use n/a for standadization
         when upper(trim(cst_gndr)) = 'm' then 'Male' -- use upper fro in daa some vale upper and lower so convert all value as per condition
         else 'n/a'                                   -- trim use for remove unwanted spaces
         end cst_gndr,
    cst_create_date
 
from

(select
*,
row_number () over (partition by cst_id order by cst_create_date) as flag_last --quality check for dublicate and null.
from bronze.crm_cust_info
where cst_id is not null) as t
where flag_last = 1 

